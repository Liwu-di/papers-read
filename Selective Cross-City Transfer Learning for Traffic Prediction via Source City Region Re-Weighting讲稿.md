1. 老师、师兄好，接下来我对我上周的工作做一个汇报。  
 
2. 上周主要是详细阅读了师兄推荐给我的文章《通过源城市区域重新赋值的选择性跨城市迁移学习进行交通预测》。在目前，深度学习在实践中，依赖于大规模的交通数据，这在现实世界的场景中并不总是可用的。为了缓解数据稀缺问题，一种方法是使用跨城市迁移学习方法从具有丰富数据的源城市微调训练有素的模型。然而，现有方法忽略了源城市和目标城市之间的差异，因此来自源城市的训练模型可能包含噪声甚至有害的源知识。因此本文的创新点就是：为了解决这个问题，我们提出了CrossTReS，这是一种用于交通预测的选择性迁移学习框架，它自适应地重新加权源区域以协助目标微调。  

3. 由于本文是一个框架性质的模型，因此在不特殊说明时，具体的实现都是类似适配器模式，不明确指明，只是给出需要完成的条件，只要符合这个条件都可以使用，此外文章中不包括具体网络，因此大多是公式表示。首先是问题的模型训练损失函数，从这两个损失函数就可以看出，框架的基本思路。对于在源数据上训练，使用区域权重lambdars进行训练，这是文章的创新点，一方面，改进了目标城市的交通预测。另一方面，增强了跨城市迁移学习的可解释性，在这个基础上，在进行微调。其中，解释参数……  
 
4. 接下来来看模型的整体结构与训练过程。首先看三个绿色框选的网络。  
    * 特征网络𝐹𝜃𝑓。在城市规划中，每个区域都承担着一定的与交通格局相关的城市功能。例如，工业区的交通流量在工作日达到高峰，而商业中心的交通流量在周末达到高峰。捕捉可概括的空间特征揭示城市之间共享的城市功能并促进知识转移。为了捕捉这些特征，我们通过节点级和边缘级域适应目标来训练特征网络。  
    * 加权网络𝐹𝜃𝑤。𝐹𝜃𝑤学习自适应地重新加权源区域。例如，如果目标城市交通畅通，那么拥堵严重的源区域将是不利的，应该降低权重。为了实现这个目标，我们通过源-目标联合元学习训练𝐹𝜃𝑓和𝐹𝜃𝑤。通过模拟内部循环中的源训练和目标微调，两个网络都被学习重新加权源区域以改进目标微调。  
    * 预测模型𝐹𝜃。𝐹𝜃在源城市上进行选择性训练，权重为𝜆𝑟S，以初始化目标微调。  

5. 具体来看，模型的工作过程如下，首先根据一些先验知识构建图，包括源城市与目的城市。再通过特征网络将图映射到向量空间，其中demb是向量维度。注意到并不指定𝐹𝜃𝑓的架构，只要它对图数据进行操作即可。然后，加权网络𝐹𝜃𝑤将区域空间特征ΦS、ΦT 转换为源区域权重𝜆𝑟S≥0。加权网络的直觉是具有相似城市功能的源区域和目标区域可能共享共同的时间特征。因此，我们首先用 𝐹𝜃𝑤 变换 ΦS 和 ΦT,然后对所有目标区域应用均值池化以获得目标城市特征。最后通过内积和 tanh激活获得源区域权重。  

6. 接下来，具体再看模型的训练过程。模型第一步的任务就是提取与城市无关的区域特征并评估源区域的有用性，从而解决选择性源训练的问题。文章设计节点和边缘级别的域适应方法  
    * 节点级适应。文章选择直接最小化两个城市的区域特征之间的最大平均差异.直观地说，节点级适应对齐了两个城市的节点（即区域）特征的分布。  
    * 边缘级适应。在使用多视图图对城市进行建模时，图中的节点（即区域）与多种类型的边相连。由于每种类型的边缘都带有独特的语义（例如道路连接、相似的起点/目的地），所以边缘级适应应该有两个特征：  
        * 不同类型边缘的特征应明确区分。  
        * 无论哪个城市，相同类型边的特征都应该相似。  
    * 论文通过共享边缘分类器实现边域适应。边缘分类器将边缘特征作为输入，输出潜在的边缘类型，并在两个城市之间共享。通过学习对边缘类型进行分类，我们确保了边缘类型的可区分性。通过跨城市共享分类器，确保了相同类型边的特征都应该相似。  
    * 从具体公式来说，边特征由节点特征做连接而来。通过交叉熵损失训练边类型分类器，最终最小化如图的损失，同时优化特征与边类型模块。  

7. 最后是通过联合元学习进行区域权重到的重新赋值。第一步是模拟源数据上的训练。通过当前的lambdars作为初始的区域权重，进行学习，优化源模型，然后以训练好的源模型作为初始模型，在目标数据集上训练，进行模拟微调。最后选择一部分目标集数据，进行损失计算，注意到对于源模型Thetas包括Theta-f和Theta-w。包括Theta-f和Theta-w。  

8. 在实验方面，选择了纽约，芝加哥，华盛顿的自行车和出租车数据。  

9. 在预测的性能方面，我们在两项任务上评估CrossTReS和基线：DC自行车和DC出租车。对于每个任务，我们从纽约和芝加哥转移。  
    * ST-Net的性能在数据有限的情况下显着下降。退化表明传输交通预测模型的数据问题非常严峻。  
    * CrossTReS变体始终优于非选择性和选择性基线。与最佳基线相比，CrossTReS在相同设置下实现了高达8%的误差减少。这些改进表明CrossTReS可以为交通预测任务提供选择性和有效的跨城市知识转移。  

10. 在空间区域特征实验中，实验比较了CrossTReS的几种变体，如下所示  
    * CrossTReS-POI：我们不学习空间特征，而是使用POI向量作为加权网络的输入；  
    * CrossTReS-NoDA：我们设置𝛽1=𝛽2=0以消除域适应。在这种情况下，ΦS、ΦT可能遵循不同的分布，这可能会影响区域重新加权。  
    * CrossTReS：具有𝛽1=𝛽2=2的完整CrossTReS。  
    * CrossTReS-GRL：对于共享边缘分类器𝐹𝜃𝑒𝑑𝑔𝑒添加一个具有梯度反转层（GRL）的对抗域鉴别器。  
    * 与CrossTReS-POI相比，学习空间特征的变体在区域分类和目标交通预测方面都更加精确。这表明特征网络学习了指示性空间特征，从而导致更有效的选择性迁移学习。  
    * 与CrossTReS-NoDA相比，CrossTReS在两个实验中都取得了更好的表现，这表明通过域适应学习可概括的区域特征，我们可以更好地识别城市间功能相似的区域，以帮助选择性迁移学习。  
    * 比较CrossTReS和CrossTReS-GRL，我们观察到非常相似的性能，表明共享边缘分类器很好地执行了边缘级域自适应，并且不需要额外的域鉴别器。  

11. 在进行的实验中，源区域的平均权重随着源训练的进行而逐渐下降，这表明在源训练过程中，模型逐渐学习到与目标城市无关的源知识，导致权重下降。随着源训练的进行，𝜆𝑟S的稀疏性逐渐增加。此外，在源训练结束时观察到高度稀疏性（60-80%的区域有𝜆𝑟S<0.25）。这两个事实都表明，CrossTReS通过分配低权重逐渐学会排除不相关的源区域。两个指标在不同的实验中显示出相似的趋势，表明CrossTReS可以稳定地选择有用的源区域。  

12. 在最后的可视化实验中，可以看出曼哈顿的权重比新泽西、布鲁克林、布朗克斯和皇后区高得多。这种现象可以用两种方式来解释。一方面，与华盛顿特区相似，曼哈顿拥有许多旅游景点，这导致热门目的地的相似性。另一方面，华盛顿特区经济发达，而曼哈顿是纽约州经济最发达的县。因此可以得出结论，CrossTReS的选择很好地对应了跨城市区域相似性的各种概念。  

13. 最后总结来看，本文提出了一种用于交通预测的选择性跨城市迁移学习框架CrossTReS，通过自适应地重新加权源区域来改进目标微调，并且取得了很好的效果。代码和数据集也是公开可以获得的。在改进的思路方面，我有以下三点想法：  
    1. 改进特征相似性的计算方法，（PPT翻到第5页）目前论文中提到的计算方法是直接进行内积，在这里可以改为将两个特征连接，经过全连接层输出权重。  
    2. 第二点是文中作者提出的，关于数据缺失的鲁棒性研究。  
    3. 第三点是我最近阅读师兄推荐的另一篇论文时想到的，可以结合知识图谱，尤其是在知识图谱中加入两个城市的相关信息，应该会有更好的结果。  

14. 以上就是我所有的汇报内容，请老师师兄批评指正  