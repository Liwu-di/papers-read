# Uncertainty Quantification of Sparse Travel Demand Prediction with Spatial-Temporal Graph Neural Networks
## 摘要
起点-终点 (O-D) 旅行需求预测是交通运输中的一项基本挑战。很少有研究解决细粒度 O-D 矩阵中的不确定性和稀疏性问题。这提出了一个严重的问题，因为大量的零点偏离了确定性深度学习模型背后的高斯假设。为了解决这个问题，我们设计了一个时空零膨胀负二项式图神经网络（STZINBGNN）来量化稀疏旅行需求的不确定性。STZINB-GNN 使用两个具有不同空间和时间分辨率的真实世界数据集进行检查。结果表明 STZINB-GNN 优于基准模型，尤其是在高时空分辨率下，因为它具有高精度、紧密的置信区间和可解释的参数。 STZINB-GNN 的稀疏参数对各种交通应用具有物理解释。
## 引言
1. 预测旅行需求的起点 - 目的地（O-D）矩阵引起了很多关注这项任务具有挑战性，因为需求数据的特征因移动服务而异。例如，地铁站的 O-D 矩阵通常是密集的，并且可能满足连续高斯分布，这隐含地成为确定性深度学习模型的基础。但对于叫车服务或共享单车服务，O-D 区域可能更加精细，这会导致 O-D 矩阵中的条目稀疏和离散。这种稀疏性问题在具有高时空分辨率的 O-D 矩阵中变得更加严重，因为最初密集的 O-D 矩阵可能变得更加稀释。随着出行公司越来越多地采用实时干预，以高时空分辨率准确预测稀疏和离散 O-D 矩阵可以显着提高出行服务的质量。
2. 尽管使用深度学习 (DL) 模型对密集和低分辨率 O-D 矩阵的预测进行了广泛研究，但很少有研究解决高分辨率旅行需求数据中的稀疏问题。密集 O-D 矩阵中的连续数据条目可以遵循高斯分布。然而，稀疏 O-D 矩阵中的大量零条目明显偏离了高斯假设。当 O-D 矩阵稀疏且以整数值分散时，像负二项分布这样的离散分布会更合适。此外，当数据集具有高时空分辨率时，自然会出现大量零。这些零点对于运输管理很重要，因为它们表示需求特别低的区域。为了解决稀疏问题，我们提出了一种时空零膨胀负二项式图神经网络 (STZINB-GNN) 来量化不确定性并提高预测性能。我们利用零膨胀负二项式 (ZINB) 分布来捕获稀疏 O-D 矩阵中的大量零，以及每个非零条目的负二项式 (NB) 分布。与变分自动编码器模型不同，我们设计了带有附加参数 𝜋 的时空嵌入，以学习输入为零的可能性。我们的模型利用时空图神经网络的表示能力来拟合概率分布的参数。我们比较了各种概率层来评估𝜋在捕获稀疏性方面的有效性。根据经验，我们证明了我们的模型在具有细粒度时空分辨率的数据集中的优越性。
3. 我们的主要贡献包括：
   1. 我们提出了 STZINB-GNN 来量化 O-D 旅行需求的时空不确定性，使用参数 𝜋 来学习数据稀疏性
   2. 概率 GNN 的参数成功地量化了稀疏和离散的不确定性，特别是在高分辨率数据集中
   3. 我们通过使用两个具有不同时空分辨率的真实世界旅行需求数据集证明了 STZINB-GNN 优于其他模型。
## 相关工作
1. 为了将我们的贡献与以前的工作区分开来，我们将强调我们的模型在旅行需求预测中的时空可解释性和不确定性量化。 
2. 稀疏出行需求预测的不确定性 除了平均值之外，人们普遍认为模型还应该预测不确定性。主导大多数研究的确定性模型隐含地假设同方差（即共同方差），这显着简化了方差结构。在非深度学习模型中，Jang [8] 表明旅行需求遵循零膨胀负二项分布。罗哈斯等人。 [28] 还指出，使用零通胀模型有望为间歇性旅行需求建模。然而，最近的需求预测论文通过选择低分辨率（例如 60 分钟）来回避这一挑战 [11, 12]。考虑更高分辨率（例如 5 分钟）具有挑战性，因为确定性 DL 模型不再适用。因此，结合零膨胀分布和确定性 DL 来分析稀疏 O-D 矩阵可能是一种可行的替代方案。
3. 设计指标来评估不确定性量化的质量也很重要。科斯拉维等人。 [14] 提出了平均预测区间宽度和预测区间覆盖概率来量化数据的不确定性。 Sankararaman 和 Mahadevan [29] 引入了基于似然的度量，这也是衡量预测数据分布和地面实况数据分布对齐情况的有效指标。基于现有的研究空白，我们的论文试图设计一个模型，该模型可以用适当的时空模式识别和严格的预测区间界限来表述稀疏的旅行需求预测问题。
## 方法
1. 定义
    1. ![OD 图](https://github.com/Liwu-di/papers-read/blob/main/pic/34.png)
    2. ![OD 图说明](https://github.com/Liwu-di/papers-read/blob/main/pic/35.png)
    3. ![defination](https://github.com/Liwu-di/papers-read/blob/main/pic/36.png)
2. 零膨胀负二项分布
   1. 负二项分布（Negative binomial distribution）是统计学上一种描述在一系列独立同分布的伯努利试验中，成功次数达到指定次数（记为r）时失败次数的离散概率分布。比如，如果我们定义掷骰子随机变量x值为x=1时成功，所有x≠1为失败，这时我们反复掷骰子直到1出现3次（成功次数r=3），此时非1数字出现次数的概率分布即为负二项分布。
   2. 若每次伯努利试验有两种可能的结果，分别为成功或者失败。在每次试验中，成功的概率为p，失败的概率为（1-p）。反复进行该伯努利试验，直到观察到第r次成功发生。此时试验失败次数X的分布即为负二项分布（或称帕斯卡分布），那么：若随机变量X服从参数为r和p的负二项分布，则记为X~NB(r,p).在实际生活中，我们可以使用负二项分布描述某种机器在坏掉前，能够工作的天数的分布。此时，“成功”的事件可以指机器正常工作一天，“失败”的事件可以指机器故障的一天。如果我们使用负二项分布来描述运动员在获取r个奖牌前尝试的次数的分布，此时，“失败”的事件指运动员的一次尝试，“成功”的事件指运动员获取一枚奖牌。如果使用负二项分布来描述掷一枚硬币出现r次正面前，出现硬币反面的次数的分布，“成功”的事件指出现硬币的正面，“失败”的事件指出现硬币的反面。
   3. ![负二项分布](https://github.com/Liwu-di/papers-read/blob/main/pic/37.png)
   4. 其中 𝑛 和 𝑝 是形状参数，分别决定成功的次数和单个失败的概率
   5. ![零膨胀负二项分布](https://github.com/Liwu-di/papers-read/blob/main/pic/38.png)
   6. 需要两个步骤来生成数据的分布：它们要么是概率为 𝜋 的零，要么是遵循 NB 分布的概率为 1 - 𝜋 的非零。概率分布中的参数 𝜋、𝑛、𝑝 由时空 GNN 参数化。  
3. 